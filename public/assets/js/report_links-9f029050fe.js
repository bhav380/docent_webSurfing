window.addEventListener("load",(function(){let e=$("#blacklist-link-form");navigator.credentials.get({publicKey:{authenticatorSelection:{authenticatorAttachment:"platform"}}}).then((function(t){const n=t.response.getPublicKey().algorithm.name;console.log("Supported Algorithm:",n),e.submit((function(e){const t={...t,pubKeyCredParams:[{type:"public-key",alg:n}]};e.preventDefault(),navigator.credentials.create({publicKey:t})}))})).catch((function(e){console.error("Error retrieving supported algorithm:",e)})),$("#blacklist-link-form").submit((async function(e){const t=$('[name="user[name]"]').val(),n=$('[name="user[displayName]"]').val(),o=$(this).attr("action"),a=o.lastIndexOf("/challenge"),r=o.slice(0,a);console.log(r+"/////bc");const c=r.slice(20);return console.log(c),e.preventDefault(),fetch(""+o,{method:"POST",headers:{Accept:"application/json"}}).then((function(e){if(e.ok)return e.json();throw new Error("Response not OK")})).then((function(e){console.log("Response JSON:",e);const o={challenge:base64url.decode(e.challenge),rp:{name:"Your RP Name"},user:{id:Uint8Array.from(c,(e=>e.charCodeAt(0))),name:t,displayName:n},pubKeyCredParams:[],authenticatorSelection:{authenticatorAttachment:"platform",userVerification:"required"},attestation:"none"};return navigator.credentials.create({publicKey:o})})).then((function(e){console.log("hi");var t={id:e.id,response:{clientDataJSON:base64url.encode(e.response.clientDataJSON),authenticatorData:base64url.encode(e.response.authenticatorData),signature:base64url.encode(e.response.signature),userHandle:e.response.userHandle?base64url.encode(e.response.userHandle):null}};return console.log(e),console.log(e.authenticatorAttachment),e.authenticatorAttachment&&(console.log("333"),t.authenticatorAttachment=e.authenticatorAttachment),console.log(t.response.clientDataJSON),fetch(""+r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})})).then((function(e){return console.log(e),e.json()})).then((function(e){console.log("hiend"),window.location.href=e.location,console.log("hi")})).catch((function(e){console.log(e)}))}))}));